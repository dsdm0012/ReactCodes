{"ast":null,"code":"import _toConsumableArray from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Participant=function Participant(_ref){var participant=_ref.participant;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),videoTracks=_useState2[0],setVideoTracks=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),audioTracks=_useState4[0],setAudioTracks=_useState4[1];var videoRef=useRef();var audioRef=useRef();var trackpubsToTracks=function trackpubsToTracks(trackMap){return Array.from(trackMap.values()).map(function(publication){return publication.track;}).filter(function(track){return track!==null;});};useEffect(function(){setVideoTracks(trackpubsToTracks(participant.videoTracks));setAudioTracks(trackpubsToTracks(participant.audioTracks));var trackSubscribed=function trackSubscribed(track){if(track.kind===\"video\"){setVideoTracks(function(videoTracks){return[].concat(_toConsumableArray(videoTracks),[track]);});}else if(track.kind===\"audio\"){setAudioTracks(function(audioTracks){return[].concat(_toConsumableArray(audioTracks),[track]);});}};var trackUnsubscribed=function trackUnsubscribed(track){if(track.kind===\"video\"){setVideoTracks(function(videoTracks){return videoTracks.filter(function(v){return v!==track;});});}else if(track.kind===\"audio\"){setAudioTracks(function(audioTracks){return audioTracks.filter(function(a){return a!==track;});});}};participant.on(\"trackSubscribed\",trackSubscribed);participant.on(\"trackUnsubscribed\",trackUnsubscribed);return function(){setVideoTracks([]);setAudioTracks([]);participant.removeAllListeners();};},[participant]);//reload to browser if video setting changes of the participant\nuseEffect(function(){var videoTrack=videoTracks[0];if(videoTrack){videoTrack.attach(videoRef.current);return function(){videoTrack.detach();};}},[videoTracks]);//reload to browser if audio setting changes of the participant\nuseEffect(function(){var audioTrack=audioTracks[0];if(audioTrack){audioTrack.attach(audioRef.current);return function(){audioTrack.detach();};}},[audioTracks]);///console.log(\"Participant: \",participant.sid )\n//console.log(\"audioTracks.length: \",audioTracks.length)\n//console.log(\"videoTracks.lengh: \", videoTracks.length)\n//console.log(\"videoRef: \", videoRef);\nvar turnOffVideoHandler=function turnOffVideoHandler(){setVideoTracks([]);};var turnOnVideoHandler=function turnOnVideoHandler(){setVideoTracks(trackpubsToTracks(participant.videoTracks));};var turnOffAudioHandler=function turnOffAudioHandler(){setAudioTracks([]);};var turnOnAudioHandler=function turnOnAudioHandler(){setAudioTracks(trackpubsToTracks(participant.audioTracks));};return/*#__PURE__*/_jsxs(\"div\",{className:\"participant\",children:[/*#__PURE__*/_jsx(\"h3\",{children:participant.identity}),/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true}),/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,autoPlay:true,muted:false}),videoTracks.length>0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:turnOffVideoHandler,children:\" video turn off\"}),videoTracks.length===0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:turnOnVideoHandler,children:\" video turn on \"}),audioTracks.length>0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:turnOffAudioHandler,children:\" audio turn off\"}),audioTracks.length===0&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:turnOnAudioHandler,children:\" audio turn on \"})]});};export default Participant;","map":null,"metadata":{},"sourceType":"module"}