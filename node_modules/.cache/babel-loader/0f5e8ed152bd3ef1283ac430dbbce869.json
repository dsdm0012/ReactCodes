{"ast":null,"code":"import _regeneratorRuntime from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect}from'react';import Video from\"twilio-video\";//import axiosInstance from '../../axios';\nimport axios from'axios';import Room from'./Room';import Lobby from'./Lobby';import{jsx as _jsx}from\"react/jsx-runtime\";var _require=require('twilio-video'),connect=_require.connect;var VideoChat=function VideoChat(){console.log(\"rerendering\");var _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),connecting=_useState8[0],setConnecting=_useState8[1];var handleUsernameChange=useCallback(function(event){setUsername(event.target.value);console.log('username change');},[]);var handleRoomNameChange=useCallback(function(event){setRoomName(event.target.value);console.log('room name change');},[]);var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),tokenData=_useState10[0],setToken=_useState10[1];var joinRoom=function joinRoom(_ref){var data=_ref.data;Video.connect(data.accessToken,{name:'coolroom'}).then(function(room){setConnecting(false);console.log(\"room: \",room);setRoom(room);});};var handleSubmit=function handleSubmit(e){e.preventDefault();setConnecting(true);console.log(\"submit data\");var susername='bibhu';axios.post(\"https://token-service-6908-dev.twil.io/token?identity=\".concat(susername),{}).then(function(res){setToken(function(tokenData){return res.data;});console.log(\"token data inside: \",res.data.token);var data=res.data;joinRoom({data:data});});};function handleSubmit2(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var usename,response,data,_room;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();usename=username;setConnecting(true);_context.prev=3;_context.next=6;return fetch(\"https://token-service-6908-dev.twil.io/token?identity=\".concat(usename));case 6:response=_context.sent;_context.next=9;return response.json();case 9:data=_context.sent;_context.next=12;return connect(data.accessToken,{name:'cool-room',audio:true,video:true});case 12:_room=_context.sent;setRoom(_room);console.log(\"room isnide submit2: \",_room);setConnecting(false);_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 21:case\"end\":return _context.stop();}}},_callee,null,[[3,18]]);}));return _handleSubmit.apply(this,arguments);}var handleLogout=function handleLogout(){console.log(\"handle Logout\");};//console.log(\"room: \", room);\nvar render;if(room){render=/*#__PURE__*/_jsx(Room,{roomName:roomName,room:room,handleLogout:handleLogout});}else{render=/*#__PURE__*/_jsx(Lobby,{username:username,roomName:roomName,handleUsernameChange:handleUsernameChange,handleRoomNameChange:handleRoomNameChange,handleSubmit:handleSubmit2,connecting:connecting});}return render;};export default VideoChat;","map":{"version":3,"sources":["/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/src/VideoPlayer/TwilioVideo/VideoChat.js"],"names":["React","useState","useCallback","useEffect","Video","axios","Room","Lobby","require","connect","VideoChat","console","log","room","setRoom","username","setUsername","roomName","setRoomName","connecting","setConnecting","handleUsernameChange","event","target","value","handleRoomNameChange","tokenData","setToken","joinRoom","data","accessToken","name","then","handleSubmit","e","preventDefault","susername","post","res","token","handleSubmit2","usename","fetch","response","json","audio","video","handleLogout","render"],"mappings":"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","sourcesContent":["import React,{useState, useCallback, useEffect} from 'react';\nimport Video from \"twilio-video\";\n//import axiosInstance from '../../axios';\nimport axios from 'axios';\n\nimport Room from './Room';\nimport Lobby from './Lobby';\nconst { connect } = require('twilio-video');\n\nconst VideoChat=()=>{\n\n\n   console.log(\"rerendering\",);\n\n   const [room, setRoom] = useState(null);\n   const [username, setUsername] = useState(\"\");\n   const [roomName, setRoomName] = useState(\"\");\t\n   const [connecting, setConnecting] = useState(false);\n\n   const handleUsernameChange = useCallback((event) => {\n    setUsername(event.target.value);\n    console.log('username change');\n\n   }, []);\n\n   const handleRoomNameChange = useCallback((event) => {\n    setRoomName(event.target.value);\n    console.log('room name change');\n\n   }, []);\n\n   const [tokenData, setToken] = useState(null);\n   \n\n   const joinRoom=({data})=>{\n           \n    Video.connect(data.accessToken, {\n        name: 'coolroom',\n      })\n        .then((room) => {\n          setConnecting(false);\n\t  console.log(\"room: \", room);\t\n          setRoom(room);\n        })\n\n   }\n\n\n  \n\n\n   const handleSubmit=(e)=>{\n    e.preventDefault();\t   \n    setConnecting(true);\n    console.log(\"submit data\");\n    let susername='bibhu'\n\n    axios.post(`https://token-service-6908-dev.twil.io/token?identity=${susername}`, {\n    \n    })\n     .then((res) => {\n         setToken(tokenData=>res.data);\n         console.log(\"token data inside: \", res.data.token);\n\t    let data=res.data; \n          joinRoom({data});\n\n\n           \n\n                })\n\n\n   }\n  \n\n    async function handleSubmit2(event) {\n \n    event.preventDefault();\t    \n    let usename=username;\t    \n    setConnecting(true);\n    try {\n       const response = await fetch(`https://token-service-6908-dev.twil.io/token?identity=${usename}`);\n       const data = await response.json();\n       const room = await connect(data.accessToken, {\n          name: 'cool-room',\n          audio: true,\n          video: true\n       });\n\n    \n      setRoom(room);\n      console.log(\"room isnide submit2: \", room);\n      setConnecting(false);\n\n      } catch(err) {\n        console.log(err);\n    }\n   }\n\n\n\n   const handleLogout=()=>{\n\n   console.log(\"handle Logout\");\n\n\n\n   }\n\n\n\n\n //console.log(\"room: \", room);\n\n\n let render;\n  if (room) {\n    render = (\n      <Room roomName={roomName} room={room} handleLogout={handleLogout}/>\n    );\n  } else {\n    render = (\n      <Lobby\n        username={username}\n        roomName={roomName}\n        handleUsernameChange={handleUsernameChange}\n        handleRoomNameChange={handleRoomNameChange}\n        handleSubmit={handleSubmit2}\n        connecting={connecting}\n      />\n\n\n\n    );\n  }\n  return render;\n\n\n\n\n\n\n\n\n\n}\n\n\nexport default VideoChat;\n"]},"metadata":{},"sourceType":"module"}