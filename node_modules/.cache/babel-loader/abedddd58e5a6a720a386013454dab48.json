{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react'; //import AgoraRTC, {\n//  IAgoraRTCClient, IAgoraRTCRemoteUser, MicrophoneAudioTrackInitConfig, CameraVideoTrackInitConfig, IMicrophoneAudioTrack, ICameraVideoTrack, ILocalVideoTrack, ILocalAudioTrack } from 'agora-rtc-sdk-ng';\n\nexport default function useAgora(client) {\n  _s();\n\n  const [localVideoTrack, setLocalVideoTrack] = useState(undefined);\n  const [localAudioTrack, setLocalAudioTrack] = useState(undefined);\n  const [joinState, setJoinState] = useState(false);\n  const [remoteUsers, setRemoteUsers] = useState([]);\n\n  async function createLocalTracks(audioConfig, videoConfig) {\n    const [microphoneTrack, cameraTrack] = await AgoraRTC.createMicrophoneAndCameraTracks(audioConfig, videoConfig);\n    setLocalAudioTrack(microphoneTrack);\n    setLocalVideoTrack(cameraTrack);\n    return [microphoneTrack, cameraTrack];\n  }\n\n  async function join(appid, channel, token, uid) {\n    if (!client) return;\n    const [microphoneTrack, cameraTrack] = await createLocalTracks();\n    await client.join(appid, channel, token || null, uid || null);\n    await client.publish([microphoneTrack, cameraTrack]);\n    window.client = client;\n    window.videoTrack = cameraTrack;\n    setJoinState(true);\n  }\n\n  async function leave() {\n    if (localAudioTrack) {\n      localAudioTrack.stop();\n      localAudioTrack.close();\n    }\n\n    if (localVideoTrack) {\n      localVideoTrack.stop();\n      localVideoTrack.close();\n    }\n\n    setRemoteUsers([]);\n    setJoinState(false);\n    await (client === null || client === void 0 ? void 0 : client.leave());\n  }\n\n  useEffect(() => {\n    if (!client) return;\n    setRemoteUsers(client.remoteUsers);\n\n    const handleUserPublished = async (user, mediaType) => {\n      await client.subscribe(user, mediaType); // toggle rerender while state of remoteUsers changed.\n\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    };\n\n    const handleUserUnpublished = user => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    };\n\n    const handleUserJoined = user => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    };\n\n    const handleUserLeft = user => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    };\n\n    client.on('user-published', handleUserPublished);\n    client.on('user-unpublished', handleUserUnpublished);\n    client.on('user-joined', handleUserJoined);\n    client.on('user-left', handleUserLeft);\n    return () => {\n      client.off('user-published', handleUserPublished);\n      client.off('user-unpublished', handleUserUnpublished);\n      client.off('user-joined', handleUserJoined);\n      client.off('user-left', handleUserLeft);\n    };\n  }, [client]);\n  return {\n    localAudioTrack,\n    localVideoTrack,\n    joinState,\n    leave,\n    join,\n    remoteUsers\n  };\n}\n\n_s(useAgora, \"kLbf8aZ5vpWMypTkJehREBqBFJQ=\");","map":{"version":3,"names":["useState","useEffect","useAgora","client","localVideoTrack","setLocalVideoTrack","undefined","localAudioTrack","setLocalAudioTrack","joinState","setJoinState","remoteUsers","setRemoteUsers","createLocalTracks","audioConfig","videoConfig","microphoneTrack","cameraTrack","AgoraRTC","createMicrophoneAndCameraTracks","join","appid","channel","token","uid","publish","window","videoTrack","leave","stop","close","handleUserPublished","user","mediaType","subscribe","Array","from","handleUserUnpublished","handleUserJoined","handleUserLeft","on","off"],"sources":["/home/bibhu/EDRdevelopment/DevBranch/ReactCodes/src/VideoPlayer/hooks/useAgora.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\n//import AgoraRTC, {\n//  IAgoraRTCClient, IAgoraRTCRemoteUser, MicrophoneAudioTrackInitConfig, CameraVideoTrackInitConfig, IMicrophoneAudioTrack, ICameraVideoTrack, ILocalVideoTrack, ILocalAudioTrack } from 'agora-rtc-sdk-ng';\n\nexport default function useAgora(client: IAgoraRTCClient | undefined)\n  :\n   {\n      localAudioTrack: ILocalAudioTrack | undefined,\n      localVideoTrack: ILocalVideoTrack | undefined,\n      joinState: boolean,\n      leave: Function,\n      join: Function,\n      remoteUsers: IAgoraRTCRemoteUser[],\n    }\n    {\n  const [localVideoTrack, setLocalVideoTrack] = useState<ILocalVideoTrack | undefined>(undefined);\n  const [localAudioTrack, setLocalAudioTrack] = useState<ILocalAudioTrack | undefined>(undefined);\n\n  const [joinState, setJoinState] = useState(false);\n\n  const [remoteUsers, setRemoteUsers] = useState<IAgoraRTCRemoteUser[]>([]);\n\n  async function createLocalTracks(audioConfig?: MicrophoneAudioTrackInitConfig, videoConfig?: CameraVideoTrackInitConfig)\n  : Promise<[IMicrophoneAudioTrack, ICameraVideoTrack]> {\n    const [microphoneTrack, cameraTrack] = await AgoraRTC.createMicrophoneAndCameraTracks(audioConfig, videoConfig);\n    setLocalAudioTrack(microphoneTrack);\n    setLocalVideoTrack(cameraTrack);\n    return [microphoneTrack, cameraTrack];\n  }\n\n  async function join(appid: string, channel: string, token?: string, uid?: string | number | null) {\n    if (!client) return;\n    const [microphoneTrack, cameraTrack] = await createLocalTracks();\n    \n    await client.join(appid, channel, token || null, uid || null);\n    await client.publish([microphoneTrack, cameraTrack]);\n\n    (window as any).client = client;\n    (window as any).videoTrack = cameraTrack;\n\n    setJoinState(true);\n  }\n\n  async function leave() {\n    if (localAudioTrack) {\n      localAudioTrack.stop();\n      localAudioTrack.close();\n    }\n    if (localVideoTrack) {\n      localVideoTrack.stop();\n      localVideoTrack.close();\n    }\n    setRemoteUsers([]);\n    setJoinState(false);\n    await client?.leave();\n  }\n\n  useEffect(() => {\n    if (!client) return;\n    setRemoteUsers(client.remoteUsers);\n\n    const handleUserPublished = async (user: IAgoraRTCRemoteUser, mediaType: 'audio' | 'video') => {\n      await client.subscribe(user, mediaType);\n      // toggle rerender while state of remoteUsers changed.\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    }\n    const handleUserUnpublished = (user: IAgoraRTCRemoteUser) => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    }\n    const handleUserJoined = (user: IAgoraRTCRemoteUser) => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    }\n    const handleUserLeft = (user: IAgoraRTCRemoteUser) => {\n      setRemoteUsers(remoteUsers => Array.from(client.remoteUsers));\n    }\n    client.on('user-published', handleUserPublished);\n    client.on('user-unpublished', handleUserUnpublished);\n    client.on('user-joined', handleUserJoined);\n    client.on('user-left', handleUserLeft);\n\n    return () => {\n      client.off('user-published', handleUserPublished);\n      client.off('user-unpublished', handleUserUnpublished);\n      client.off('user-joined', handleUserJoined);\n      client.off('user-left', handleUserLeft);\n    };\n  }, [client]);\n\n  return {\n    localAudioTrack,\n    localVideoTrack,\n    joinState,\n    leave,\n    join,\n    remoteUsers,\n  };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}