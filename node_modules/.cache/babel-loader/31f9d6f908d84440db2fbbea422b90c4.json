{"ast":null,"code":"import _regeneratorRuntime from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useCallback,useEffect}from'react';import Video from\"twilio-video\";//import axiosInstance from '../../axios';\nimport axios from'axios';import Room from'./Room';import Lobby from'./Lobby';import{jsx as _jsx}from\"react/jsx-runtime\";var _require=require('twilio-video'),connect=_require.connect;var VideoChat=function VideoChat(){//console.log(\"rerendering\",);\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),roomName=_useState6[0],setRoomName=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),connecting=_useState8[0],setConnecting=_useState8[1];var handleUsernameChange=useCallback(function(event){setUsername(event.target.value);//console.log('username change');\n},[]);var handleRoomNameChange=useCallback(function(event){setRoomName(event.target.value);//console.log('room name change');\n},[]);var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),tokenData=_useState10[0],setToken=_useState10[1];var joinRoom=function joinRoom(_ref){var data=_ref.data;Video.connect(data.accessToken,{name:'coolroom'}).then(function(room){setConnecting(false);//console.log(\"room: \", room);\t\nsetRoom(room);});};var handleSubmit=function handleSubmit(e){e.preventDefault();setConnecting(true);//console.log(\"submit data\");\nvar susername='bibhu';axios.post(\"https://token-service-6908-dev.twil.io/token?identity=\".concat(susername),{}).then(function(res){setToken(function(tokenData){return res.data;});//console.log(\"token data inside: \", res.data.token);\nvar data=res.data;joinRoom({data:data});});};function handleSubmit2(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var usename,response,data,_room;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();usename=username;setConnecting(true);_context.prev=3;_context.next=6;return fetch(\"https://token-service-6908-dev.twil.io/token?identity=\".concat(usename));case 6:response=_context.sent;_context.next=9;return response.json();case 9:data=_context.sent;_context.next=12;return connect(data.accessToken,{name:'cool-room',audio:true,video:true});case 12:_room=_context.sent;setRoom(_room);//console.log(\"room isnide submit2: \", room);\nsetConnecting(false);_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](3);console.log(_context.t0);case 20:case\"end\":return _context.stop();}}},_callee,null,[[3,17]]);}));return _handleSubmit.apply(this,arguments);}var handleLogout=function handleLogout(){//console.log(\"handle Logout\");\n};//console.log(\"room: \", room);\nvar render;if(room){render=/*#__PURE__*/_jsx(Room,{roomName:roomName,room:room,handleLogout:handleLogout});}else{render=/*#__PURE__*/_jsx(Lobby,{username:username,roomName:roomName,handleUsernameChange:handleUsernameChange,handleRoomNameChange:handleRoomNameChange,handleSubmit:handleSubmit2,connecting:connecting});}return render;};export default VideoChat;","map":{"version":3,"sources":["/home/bibhu/EDRdevelopment/DevBranch/edresearchweb/src/VideoPlayer/TwilioVideo/VideoChat.js"],"names":["React","useState","useCallback","useEffect","Video","axios","Room","Lobby","require","connect","VideoChat","room","setRoom","username","setUsername","roomName","setRoomName","connecting","setConnecting","handleUsernameChange","event","target","value","handleRoomNameChange","tokenData","setToken","joinRoom","data","accessToken","name","then","handleSubmit","e","preventDefault","susername","post","res","handleSubmit2","usename","fetch","response","json","audio","video","console","log","handleLogout","render"],"mappings":"wfAAA,MAAOA,CAAAA,KAAP,EAAcC,QAAd,CAAwBC,WAAxB,CAAqCC,SAArC,KAAqD,OAArD,CACA,MAAOC,CAAAA,KAAP,KAAkB,cAAlB,CACA;AACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,IAAP,KAAiB,QAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,SAAlB,C,2CACA,aAAoBC,OAAO,CAAC,cAAD,CAA3B,CAAQC,OAAR,UAAQA,OAAR,CAEA,GAAMC,CAAAA,SAAS,CAAC,QAAVA,CAAAA,SAAU,EAAI,CAGjB;AAEA,cAAwBT,QAAQ,CAAC,IAAD,CAAhC,wCAAOU,IAAP,eAAaC,OAAb,eACA,eAAgCX,QAAQ,CAAC,EAAD,CAAxC,yCAAOY,QAAP,eAAiBC,WAAjB,eACA,eAAgCb,QAAQ,CAAC,EAAD,CAAxC,yCAAOc,QAAP,eAAiBC,WAAjB,eACA,eAAoCf,QAAQ,CAAC,KAAD,CAA5C,yCAAOgB,UAAP,eAAmBC,aAAnB,eAEA,GAAMC,CAAAA,oBAAoB,CAAGjB,WAAW,CAAC,SAACkB,KAAD,CAAW,CACnDN,WAAW,CAACM,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX,CACA;AAEA,CAJuC,CAIrC,EAJqC,CAAxC,CAMA,GAAMC,CAAAA,oBAAoB,CAAGrB,WAAW,CAAC,SAACkB,KAAD,CAAW,CACnDJ,WAAW,CAACI,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX,CACA;AAEA,CAJuC,CAIrC,EAJqC,CAAxC,CAMA,eAA8BrB,QAAQ,CAAC,IAAD,CAAtC,0CAAOuB,SAAP,gBAAkBC,QAAlB,gBAGA,GAAMC,CAAAA,QAAQ,CAAC,QAATA,CAAAA,QAAS,MAAU,IAARC,CAAAA,IAAQ,MAARA,IAAQ,CAExBvB,KAAK,CAACK,OAAN,CAAckB,IAAI,CAACC,WAAnB,CAAgC,CAC5BC,IAAI,CAAE,UADsB,CAAhC,EAGKC,IAHL,CAGU,SAACnB,IAAD,CAAU,CACdO,aAAa,CAAC,KAAD,CAAb,CACP;AACON,OAAO,CAACD,IAAD,CAAP,CACD,CAPL,EASA,CAXD,CAiBA,GAAMoB,CAAAA,YAAY,CAAC,QAAbA,CAAAA,YAAa,CAACC,CAAD,CAAK,CACvBA,CAAC,CAACC,cAAF,GACAf,aAAa,CAAC,IAAD,CAAb,CACA;AACA,GAAIgB,CAAAA,SAAS,CAAC,OAAd,CAEA7B,KAAK,CAAC8B,IAAN,iEAAoED,SAApE,EAAiF,EAAjF,EAGEJ,IAHF,CAGO,SAACM,GAAD,CAAS,CACXX,QAAQ,CAAC,SAAAD,SAAS,QAAEY,CAAAA,GAAG,CAACT,IAAN,EAAV,CAAR,CACC;AACL,GAAIA,CAAAA,IAAI,CAACS,GAAG,CAACT,IAAb,CACKD,QAAQ,CAAC,CAACC,IAAI,CAAJA,IAAD,CAAD,CAAR,CAKO,CAZb,EAeA,CArBD,CA1CiB,QAkEDU,CAAAA,aAlEC,gJAkEhB,iBAA6BjB,KAA7B,kJAEAA,KAAK,CAACa,cAAN,GACIK,OAHJ,CAGYzB,QAHZ,CAIAK,aAAa,CAAC,IAAD,CAAb,CAJA,sCAM0BqB,CAAAA,KAAK,iEAA0DD,OAA1D,EAN/B,QAMSE,QANT,qCAOsBA,CAAAA,QAAQ,CAACC,IAAT,EAPtB,QAOSd,IAPT,sCAQsBlB,CAAAA,OAAO,CAACkB,IAAI,CAACC,WAAN,CAAmB,CAC1CC,IAAI,CAAE,WADoC,CAE1Ca,KAAK,CAAE,IAFmC,CAG1CC,KAAK,CAAE,IAHmC,CAAnB,CAR7B,SAQShC,KART,eAeEC,OAAO,CAACD,KAAD,CAAP,CACA;AACAO,aAAa,CAAC,KAAD,CAAb,CAjBF,iFAoBI0B,OAAO,CAACC,GAAR,cApBJ,qEAlEgB,+CA4FjB,GAAMC,CAAAA,YAAY,CAAC,QAAbA,CAAAA,YAAa,EAAI,CAEvB;AAIC,CAND,CAWF;AAGA,GAAIC,CAAAA,MAAJ,CACC,GAAIpC,IAAJ,CAAU,CACRoC,MAAM,cACJ,KAAC,IAAD,EAAM,QAAQ,CAAEhC,QAAhB,CAA0B,IAAI,CAAEJ,IAAhC,CAAsC,YAAY,CAAEmC,YAApD,EADF,CAGD,CAJD,IAIO,CACLC,MAAM,cACJ,KAAC,KAAD,EACE,QAAQ,CAAElC,QADZ,CAEE,QAAQ,CAAEE,QAFZ,CAGE,oBAAoB,CAAEI,oBAHxB,CAIE,oBAAoB,CAAEI,oBAJxB,CAKE,YAAY,CAAEc,aALhB,CAME,UAAU,CAAEpB,UANd,EADF,CAaD,CACD,MAAO8B,CAAAA,MAAP,CAUD,CAxID,CA2IA,cAAerC,CAAAA,SAAf","sourcesContent":["import React,{useState, useCallback, useEffect} from 'react';\nimport Video from \"twilio-video\";\n//import axiosInstance from '../../axios';\nimport axios from 'axios';\n\nimport Room from './Room';\nimport Lobby from './Lobby';\nconst { connect } = require('twilio-video');\n\nconst VideoChat=()=>{\n\n\n   //console.log(\"rerendering\",);\n\n   const [room, setRoom] = useState(null);\n   const [username, setUsername] = useState(\"\");\n   const [roomName, setRoomName] = useState(\"\");\t\n   const [connecting, setConnecting] = useState(false);\n\n   const handleUsernameChange = useCallback((event) => {\n    setUsername(event.target.value);\n    //console.log('username change');\n\n   }, []);\n\n   const handleRoomNameChange = useCallback((event) => {\n    setRoomName(event.target.value);\n    //console.log('room name change');\n\n   }, []);\n\n   const [tokenData, setToken] = useState(null);\n   \n\n   const joinRoom=({data})=>{\n           \n    Video.connect(data.accessToken, {\n        name: 'coolroom',\n      })\n        .then((room) => {\n          setConnecting(false);\n\t  //console.log(\"room: \", room);\t\n          setRoom(room);\n        })\n\n   }\n\n\n  \n\n\n   const handleSubmit=(e)=>{\n    e.preventDefault();\t   \n    setConnecting(true);\n    //console.log(\"submit data\");\n    let susername='bibhu'\n\n    axios.post(`https://token-service-6908-dev.twil.io/token?identity=${susername}`, {\n    \n    })\n     .then((res) => {\n         setToken(tokenData=>res.data);\n          //console.log(\"token data inside: \", res.data.token);\n\t    let data=res.data; \n          joinRoom({data});\n\n\n           \n\n                })\n\n\n   }\n  \n\n    async function handleSubmit2(event) {\n \n    event.preventDefault();\t    \n    let usename=username;\t    \n    setConnecting(true);\n    try {\n       const response = await fetch(`https://token-service-6908-dev.twil.io/token?identity=${usename}`);\n       const data = await response.json();\n       const room = await connect(data.accessToken, {\n          name: 'cool-room',\n          audio: true,\n          video: true\n       });\n\n    \n      setRoom(room);\n      //console.log(\"room isnide submit2: \", room);\n      setConnecting(false);\n\n      } catch(err) {\n        console.log(err);\n    }\n   }\n\n\n\n   const handleLogout=()=>{\n\n   //console.log(\"handle Logout\");\n\n\n\n   }\n\n\n\n\n //console.log(\"room: \", room);\n\n\n let render;\n  if (room) {\n    render = (\n      <Room roomName={roomName} room={room} handleLogout={handleLogout}/>\n    );\n  } else {\n    render = (\n      <Lobby\n        username={username}\n        roomName={roomName}\n        handleUsernameChange={handleUsernameChange}\n        handleRoomNameChange={handleRoomNameChange}\n        handleSubmit={handleSubmit2}\n        connecting={connecting}\n      />\n\n\n\n    );\n  }\n  return render;\n\n\n\n\n\n\n\n\n\n}\n\n\nexport default VideoChat;\n"]},"metadata":{},"sourceType":"module"}